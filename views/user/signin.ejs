<!-- 로그인 ejs -->
<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>로그인</title>
    </head>
    <body>
        <form name="formInfo">
            <input type="hidden" name="userId" />
        </form>

        <form name="logInForm">
            <input type="text" id="userId" name="userId" placeholder="아이디 입력" required />
            <input type="password" id="userPw" name="userPw" placeholder="비밀번호 입력" required />
            <br />
            <button type="submit" onclick="signIn()">로그인</button>
            <br />
            <button type="submit" onclick="location.href='signup.ejs'">회원가입</button>
        </form>
        <script>
            function signIn() {
                const form = document.forms["logInForm"];
                const formInfo = document.forms["formInfo"];

                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                axios({
                    method: "POST",
                    url: "/user/signIn",
                    data: {
                        userId: form.userId.value,
                        userPw: form.userPw.value,
                    },
                }).then((res) => {
                    console.log(res);
                    const { data } = res;

                    if (data) {
                        formInfo.userId.value = form.userId.value;
                        formInfo.submit();
                    } else {
                        form.reset();
                    }
                });
            }
        </script>
    </body>
</html>
